variables:
  Configuration: Release
  Verbosity: Normal
  Coverage: '$(Agent.BuildDirectory)/c'
  VstsCoverage: '$(Coverage)'
  Artifacts: $(Build.ArtifactStagingDirectory)
  VstsArtifacts: '$(Artifacts)'
  # system.enableAccessToken: 'true'
  DOTNET_SKIP_FIRST_TIME_EXPERIENCE: 'true'
  DotNetVersion: "2.1.401"
  NuGetVersion: "4.6.2"
  CakeVersion: "0.30.0"
jobs:
- job: macOS
  pool:
    vmImage: 'macOS-10.13'
  steps:
  - template: tools/dotnet-core.yml
    parameters:
      CakeVersion: '$(CakeVersion)'
      DotNetVersion: '$(DotNetVersion)'
  - template: tools/azure-build.yml
    parameters:
      Script: 'cakefile.cake'
      Target: 'Default'
      Configuration: '$(Configuration)'
      Verbosity: '$(Verbosity)'

- job: Linux
  pool:
    vmImage: 'Ubuntu-16.04'
  steps:
  - template: tools/dotnet-core.yml
    parameters:
      CakeVersion: '$(CakeVersion)'
      DotNetVersion: '$(DotNetVersion)'
  - template: tools/azure-build.yml
    parameters:
      Script: 'cakefile.cake'
      Target: 'Default'
      Configuration: '$(Configuration)'
      Verbosity: '$(Verbosity)'

- job: Windows
  pool:
    vmImage: 'VS2017-Win2016'
  steps:
  - template: tools/dotnet-core.yml
    parameters:
      CakeVersion: '$(CakeVersion)'
      DotNetVersion: '$(DotNetVersion)'
  - template: tools/azure-build.yml
    parameters:
      Script: 'cakefile.cake'
      Target: 'Default'
      Configuration: '$(Configuration)'
      Verbosity: '$(Verbosity)'
